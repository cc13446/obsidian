## xv6 启动过程

### 进程概述
xv6 使用页表为每个进程提供其独有的地址空间，页表将虚拟地址映射为物理地址。

每个进程的地址空间从高到低分为以下几个区域:
- `0xffffffff-0x80100000`：内核内存，所有进程共享
- `0x80100000-0x80000000`：BIOS
- 堆
- 用户栈
- 全局变量

xv6使用结构体`proc`维护一个进程的状态：
- 用户栈
- `kstack`：内核栈
- `state`：运行状态
- `pgdir`：页表

当进程使用系统调用时，处理器转入内核栈中，提升硬件的特权级，然后运行系统调用对应的内核代码。当系统调用完成时，又降低硬件特权级从内核空间回到用户空间，转入用户栈，恢复执行系统调用指令后面的那条用户指令。进程的线程交替地使用着用户栈和内核栈。要注意内核栈是用户代码无法使用的，这样即使一个进程破坏了自己的用户栈，内核也能保持运行。

